package game.engine;

import java.awt.*;
import java.awt.image.BufferedImage;
import java.util.Iterator;

public class Camera extends Component
{
	private BufferedImage imageBuffer;
	
	public void start() 
	{
		imageBuffer = new BufferedImage(Screen.width, Screen.height, BufferedImage.TYPE_INT_RGB);
		System.out.println("#1 " + (Game.instance == null));
		System.out.println("#2 " + (Game.instance.getActiveScene() == null));
		System.out.println("#3 " + (Game.instance.getActiveScene().cameras == null));
		System.out.println("#4 " + (this == null));
		Game.instance.getActiveScene().cameras.add(this);
	}
	
	public void draw(Game game, Iterator<GameObject> gameObjects)
	{
		Graphics graphics = imageBuffer.getGraphics();
		
		// Background
		graphics.setColor(Color.white);
		graphics.fillRect(0, 0, Screen.width, Screen.height);
		graphics.setColor(Color.black);

		for(Iterator<GameObject> i = gameObjects; i.hasNext();)
		{
			i.next().draw(graphics, gameObject.transform.position);
		}
		
		Renderer.graphics.drawImage(imageBuffer, (int)gameObject.transform.position.x, (int)gameObject.transform.position.y, Screen.width, Screen.height, game);
	}
}