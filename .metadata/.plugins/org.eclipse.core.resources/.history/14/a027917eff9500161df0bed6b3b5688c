package game.engine;

import java.awt.event.KeyEvent;

public class CharacterController extends Component
{
	private float gravity = 9.81f * 32f;
	private float x = 0;
	private float y = 0;
	
	public void update()
	{
		x = 0;
		y = 0;
		
		if(Input.getKey(KeyEvent.VK_UP) && Physics.raycast(transform.position, new Vector2(0f, -1f), 16f).length == 0)
		{
			y--;
		}
		
		if(Input.getKey(KeyEvent.VK_DOWN) && Physics.raycast(transform.position, new Vector2(0f, 1f), 16f).length == 0)
		{
			y++;
		}
		
		if(Input.getKey(KeyEvent.VK_LEFT) && Physics.raycast(transform.position, new Vector2(-1f, 0f), 16f).length == 0)
		{
			x--;
		}
		
		if(Input.getKey(KeyEvent.VK_RIGHT) && Physics.raycast(transform.position, new Vector2(1f, 0f), 16f).length == 0)
		{
			x++;
		}

		Vector2 direction = new Vector2(x, y).normalized();
		if(Physics.raycast(transform.position, new Vector2(0f, 1f), gravity * Time.deltaTime - 1).length == 0)
			direction.add(new Vector2(0f, gravity * Time.deltaTime));
		transform.position.add(direction);
	}
	
	public void onGUI()
	{
		super.onGUI();
		Physics.raycast(transform.position, new Vector2(0f, y), 16f);
		Physics.raycast(transform.position, new Vector2(x, 0f), 16f);
	}
}